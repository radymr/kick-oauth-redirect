<!DOCTYPE html>
<html>
<head>
  <title>Kick OAuth Redirect</title>
  <script>
    // Immediately send the full redirect URL back to the extension
    (function () {
      const hash = window.location.hash;
      if (hash.includes("access_token")) {
        const redirectUrl = window.location.href;

        // Send it to the extension
        const message = { type: "oauth_redirect", url: redirectUrl };
        window.opener.postMessage(message, "*");
        window.close();
      } else {
        document.body.innerText = "Authorization failed or was canceled.";
      }
    })();
  </script>
</head>
<body>
  Redirecting...
</body>
</html>
